<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="main.css" type="text/css" />
<link rel="stylesheet" href="blog.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="Subscribe to this page..." href="feed.rss" />
<title>Begin all Docker files with...</title>
</head><body>
<div id="divbodyholder">
<div class="headerholder"><div class="header">
<div id="title">
<h1 class="nomargin"><a class="ablack" href="http://matt-at.keyboard-writes-code.com//index.html">Matt at Keyboard Writes Code</a></h1>
<div id="description">A blog about software development, technology and other things that interest me</div>
</div></div></div>
<div id="divbody"><div class="content">
<!-- entry begin -->
<h3><a class="ablack" href="2014-06-21-begin-all-docker-files-with___.html">
Begin all Docker files with...
</a></h3>
<!-- bashblog_timestamp: #201406210830.01# -->
<div class="subtitle">June 21, 2014 &mdash; 
Matt Forrester
</div>
<!-- text begin -->
<p>I've just had an extremely frustrating mostly wasted day with Docker. It turns out that, at least with Ubuntu 14.04 the root user is quite messed up, for example it's home directory ends up being just <code>/</code> and worse than that putting files like <code>.ssh/known_hosts</code> in the root (or <code>/root</code>) just does not work, at least for Git checkouts over SSH. I think this is the most elegant solution:</p>
<pre><code>FROM ubuntu:14.04
MAINTAINER YOUR_NAME

RUN useradd -m -s /bin/bash ubuntu
RUN echo "ubuntu ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers.d/10-ubuntu_no_password

# Uncomment the following for cool provisioning...
# RUN sudo su ubuntu -c "ansible-playbook -c local playbook.yml"
</code></pre>
<p>Honestly it took me far to long to come round to this solution, probably because I'm used to Amazon and Vagrant which both give you a working evironment when the machine boots... of course Docker doesn't technically "boot" but I'm not too impressed with how broken it is by default.</p>
<p>Docker bug open since November: <a href="https://github.com/dotcloud/docker/issues/2968">https://github.com/dotcloud/docker/issues/2968</a></p>




<!-- text end -->
<!-- entry end -->
</div>
<div id="footer">All rights reserved <a href="http://matt-at.keyboard-writes-code.com/me.html">Matt Forrester</a> &mdash; <a href="mailto:matt&#64;keyboardwritescode&#46;com">matt&#64;keyboardwritescode&#46;com</a><br/>
Generated with <a href="https://github.com/cfenollosa/bashblog">bashblog</a>, a single bash script to easily create blogs like this one</div>
</div></div>
</body></html>
